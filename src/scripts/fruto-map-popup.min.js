Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),l=o.length>>>0;if(0===l)return!1;var n,i,r=0|t,c=Math.max(0<=r?r:l-Math.abs(r),0);for(;c<l;){if((n=o[c])===(i=e)||"number"==typeof n&&"number"==typeof i&&isNaN(n)&&isNaN(i))return!0;c++}return!1}});var levelItems=Array.prototype.slice.call(document.querySelectorAll(".level__item")).filter(function(e){return Array.prototype.slice.call(e.classList).includes("level__item--future")?void 0:e}),gameBlock=document.querySelector(".game-block"),closePopupBtn=document.querySelector(".btn-close"),overlay=document.querySelector(".overlay"),pageHeaderToggle=document.querySelector(".page-header__toggle"),mainNav=document.querySelector(".main-nav"),moveBlock=document.querySelector(".move-wrapper"),contentHeight=document.querySelector(".bg-wrapper--map"),fruitItem=document.querySelector(".fruit-item__left-4"),soonButton=document.querySelector(".level__item--date"),soonPopupOverlay=document.querySelector(".date-popup"),soonPopup=soonPopupOverlay.querySelector(".popup-item"),soonPopupClose=soonPopup.querySelector(".popup-close"),levelQuestion=document.querySelector(".level__item--sign");soonButton.addEventListener("click",function(e){soonPopupOverlay.style.display="flex",soonPopup.style.display="block"}),soonPopupClose.addEventListener("click",function(){soonPopupOverlay.style.display="none",soonPopup.style.display="none"});var ideaButton=document.querySelector(".level__item--sign"),contestButton=document.querySelector(".contest"),beeTopButton=document.querySelector(".img-block--top"),beeBottomButton=document.querySelector(".img-block--bottom"),beeDescriptionButton=document.querySelector(".bee__description");beeDescriptionButton.addEventListener("click",function(e){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"});var ideaPopupOverlay=document.querySelector(".popup-idea"),ideaPopup=ideaPopupOverlay.querySelector(".popup-item"),ideaPopupClose=ideaPopup.querySelector(".popup-close");ideaButton.addEventListener("click",function(e){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),contestButton.addEventListener("click",function(){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),beeTopButton.addEventListener("click",function(){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),beeBottomButton.addEventListener("click",function(){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),ideaPopupClose.addEventListener("click",function(){ideaPopupOverlay.style.display="none",ideaPopup.style.display="none"});var currentLevelIdx=1;function openLevelPopup(s){s.addEventListener("click",function(e){var t=s.className.split(" ")[currentLevelIdx],o=new XMLHttpRequest;if(o.open("GET","fruto-map-level.json",!1),o.send(),200!=o.status)alert(o.status+": "+o.statusText);else{var l=JSON.parse(o.responseText)[t],n=gameBlock.querySelector(".game-title"),i=gameBlock.querySelector(".list-items"),r=document.createElement("span");r.innerHTML="Вам понадобится",i.appendChild(r);var c=gameBlock.querySelector(".rules-info .description"),a=gameBlock.querySelector(".product-info__image img"),p=gameBlock.querySelector(".animating"),u=gameBlock.querySelector(".product-info__text .description");n.innerHTML=l.levelName,l.ingredients.forEach(function(e,t){var o=document.createElement("li");o.innerHTML=l.ingredients[t],o.classList.add("list-items__item"),i.appendChild(o)}),c.innerHTML=l.description,a.setAttribute("src","./"+l.productSrc),console.log(l.animationSrc),p.setAttribute("src","./"+l.animationSrc),u.innerHTML=l.productText,moveBlock.style.display="none",overlay.style.display="block",gameBlock.style.display="block",contentHeight.style.overflow="hidden",fruitItem.style.display="none"}})}function closeAndClearPopup(){moveBlock.style.display="block",overlay.style.display="none",gameBlock.querySelector(".list-items").innerHTML="",gameBlock.style.display="none",contentHeight.style.overflow="visible"}levelItems.forEach(function(e){openLevelPopup(e)}),levelItems.forEach(function(e){e.addEventListener("click",function(e){document.addEventListener("keydown",function(e){27===e.keyCode&&closeAndClearPopup()})})}),closePopupBtn.addEventListener("click",function(e){closeAndClearPopup()}),pageHeaderToggle.addEventListener("click",function(e){document.addEventListener("keydown",function(e){console.log(e),27===e.keyCode&&mainNav.classList.add("main-nav--closed")})});
