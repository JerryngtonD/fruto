Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,o){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),l=t.length>>>0;if(0===l)return!1;var n,r,i=0|o,c=Math.max(0<=i?i:l-Math.abs(i),0);for(;c<l;){if((n=t[c])===(r=e)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;c++}return!1}});var levelItems=Array.prototype.slice.call(document.querySelectorAll(".level__item")).filter(function(e){return Array.prototype.slice.call(e.classList).includes("level__item--future")?void 0:e}),gameBlock=document.querySelector(".game-block"),closePopupBtn=document.querySelector(".btn-close"),overlay=document.querySelector(".overlay"),pageHeaderToggle=document.querySelector(".page-header__toggle"),mainNav=document.querySelector(".main-nav"),moveBlock=document.querySelector(".move-wrapper"),contentHeight=document.querySelector(".bg-wrapper--map"),fruitItem=document.querySelector(".fruit-item__left-4"),soonButton=document.querySelector(".level__item--date"),soonPopupOverlay=document.querySelector(".date-popup"),soonPopup=soonPopupOverlay.querySelector(".popup-item"),soonPopupClose=soonPopup.querySelector(".popup-close"),levelQuestion=document.querySelector(".level__item--sign");soonButton.addEventListener("click",function(e){soonPopupOverlay.style.display="flex",soonPopup.style.display="block"}),soonPopupClose.addEventListener("click",function(){soonPopupOverlay.style.display="none",soonPopup.style.display="none"});var ideaButton=document.querySelector(".level__item--sign"),contestButton=document.querySelector(".contest"),beeTopButton=document.querySelector(".img-block--top"),beeBottomButton=document.querySelector(".img-block--bottom"),ideaPopupOverlay=document.querySelector(".popup-idea"),ideaPopup=ideaPopupOverlay.querySelector(".popup-item"),ideaPopupClose=ideaPopup.querySelector(".popup-close");ideaButton.addEventListener("click",function(e){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),contestButton.addEventListener("click",function(){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),beeTopButton.addEventListener("click",function(){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),beeBottomButton.addEventListener("click",function(){ideaPopupOverlay.style.display="flex",ideaPopup.style.display="block"}),ideaPopupClose.addEventListener("click",function(){ideaPopupOverlay.style.display="none",ideaPopup.style.display="none"});var currentLevelIdx=1;function openLevelPopup(s){s.addEventListener("click",function(e){var o=s.className.split(" ")[currentLevelIdx],t=new XMLHttpRequest;if(t.open("GET","fruto-map-level.json",!1),t.send(),200!=t.status)alert(t.status+": "+t.statusText);else{var l=JSON.parse(t.responseText)[o],n=gameBlock.querySelector(".game-title"),r=gameBlock.querySelector(".list-items"),i=document.createElement("span");i.innerHTML="Вам понадобится",r.appendChild(i);var c=gameBlock.querySelector(".rules-info .description"),a=gameBlock.querySelector(".product-info__image img"),u=gameBlock.querySelector(".animating"),p=gameBlock.querySelector(".product-info__text .description");n.innerHTML=l.levelName,l.ingredients.forEach(function(e,o){var t=document.createElement("li");t.innerHTML=l.ingredients[o],t.classList.add("list-items__item"),r.appendChild(t)}),c.innerHTML=l.description,a.setAttribute("src","./"+l.productSrc),console.log(l.animationSrc),u.setAttribute("src","./"+l.animationSrc),p.innerHTML=l.productText,moveBlock.style.display="none",overlay.style.display="block",gameBlock.style.display="block",contentHeight.style.overflow="hidden",fruitItem.style.display="none"}})}function closeAndClearPopup(){moveBlock.style.display="block",overlay.style.display="none",gameBlock.querySelector(".list-items").innerHTML="",gameBlock.style.display="none",contentHeight.style.overflow="visible"}levelItems.forEach(function(e){openLevelPopup(e)}),levelItems.forEach(function(e){e.addEventListener("click",function(e){document.addEventListener("keydown",function(e){27===e.keyCode&&closeAndClearPopup()})})}),closePopupBtn.addEventListener("click",function(e){closeAndClearPopup()}),pageHeaderToggle.addEventListener("click",function(e){document.addEventListener("keydown",function(e){console.log(e),27===e.keyCode&&mainNav.classList.add("main-nav--closed")})});
